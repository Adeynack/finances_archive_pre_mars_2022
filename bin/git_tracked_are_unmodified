#!/bin/bash

# Checks if the GIT-tracked files are modified.
# If not, exists with 0.
# If so, lists all uncommited changes and exists with 1 (useful for failing C.I.).

if [ -z "$(git status --untracked-files=no --porcelain)" ]; then
  # Working directory clean
  exit 0
fi

# Uncommitted changes
echo "The following tracked files have changed:"
git status --untracked-files=no --porcelain
echo ""
echo "Here is the complete diff:"
git --no-pager diff --diff-algorithm=patience --color

exit 1
